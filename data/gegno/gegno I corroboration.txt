# Copyright (c) 2023 by Saugia
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.


mission "Passive-Aggressive Observations"
	invisible
	landing
	destination "Vigales"
	to offer
		random < 30
		has "First Contact: Gegno Scin: offered"
		not "Gegno Genocide Defense: offered"
	on complete
		conversation
			`While navigating the skies of this desert world, you notice familiar readings to the planet you previously encountered a member of the Gegno Vi on. It's likely this world is also home to the same or similar species of large, worm-like creatures you confronted back then. Eventually, you come across a large Gegno Vi vessel stationed on the surface, though unlike in your prior experience, the ship isn't sunken into the desert, likely having recently landed here. A group of Vi warriors are marching out and nearby the vessel, and while they do, your radar picks up two more ships descending from above.`
			choice
				`	(Leave.)`
					goto leave
				`	(Continue to observe.)`
			`	The approaching ships continue their descent, paying you no attention. They appear to be ones that were in orbit when you first entered the system. One of them is the same type of model as the one on the ground, likely some type of transport. The other, however, isn't one you've seen before. It looks like some sort of interceptor vessel, though it is definitely larger than something like a Sparrow from human space, maybe even the size of a Headhunter. Perhaps that ship belongs to someone of importance.`
			`	In any case, considering that the planet is home to more of those monsters from before, and the Vi are here in numbers, it might be best you take your leave now before the situation gets out of control again.`
			choice
				`	(Leave.)`
					goto leave
				`	(Approach the landing zone.)`
			`	Throttling your ship forward, you head towards the Vi's landing zone. While the other transport vessel has touched down already, the interceptor is still in the process of landing, but suddenly whips around to face you as you approach. Unlike the initial reaction of the Scin's warships you confronted a few days ago, the Vi are quick to respond to your presence, and in contrast to a few minutes ago, are clearly acknowledging it. A moment later, you receive what sounds like an angry hail from the interceptor.`
			`	"Tchii ciei escitch tchii iedf teih Voordhte!"`
			choice
				`	(Leave now.)`
				`	(Continue.)`
					goto continue
			`	You decide it's best to not enroach on the Vi's area any more, as there's no telling what they'd do if you continued to do so. Once you back off, the interceptor briefly jerks forward at you in a vexed manner, continuing to observe you until you've left the area. While the Scin seemed more open to interaction, the Vi are clearly adversive to it.`
				decline

			label continue
			action
				"reputation: Gegno Vi" = -1
			action
				set "provoked military"
			`	You decide to continue flying towards the Vi without heeding their warning. With no hesitation, the interceptor begins to charge at you, and the ships on the surface start preparing for takeoff. Even some of the Vi solders on the ground are shouting and gesturing towards your vessel with their weapons. It would seem the Vi are no longer tolerative of your presence.`
				decline

			label leave
			action
				set "gegno: left observations"
			`	You decide to withdraw from the area, and the ships continue on their way towards the surface as if you weren't present. Regardless of whether or not they could have been hostile, getting mixed up with what may be some sort of military exercise could be dangerous, especially with the Vi.`
				decline

	npc save
		on kill
			set "yvx killed"
		government "Gegno Vi"
		personality heroic vindictive staying ramming daring uninterested swarming
		system "Vorsuke"
		ship "Rhyolite" "Imtydei"
	npc save
		government "Gegno Vi"
		personality heroic vindictive staying uninterested swarming
		system "Vorsuke"
		ship "Schist" "Ess Ouec"

mission "Vi Military Group"
	# invisible
	landing
	to offer
		has "Passive-Aggressive Observations: done"
	to complete
		never
	on enter "Vorsuke"
		fail

	npc
		to spawn
			has "provoked military"
		on kill
			set "yvx killed"
		government "Gegno Vi"
		personality heroic vindictive ramming daring staying launching
		system "Vorsuke"
		ship "Rhyolite" "Imtydei"
	npc
		to spawn
			has "provoked military"
		government "Gegno Vi"
		personality heroic vindictive staying launching
		system "Vorsuke"
		ship "Schist" "Ess Ouec"
	npc
		to spawn
			has "provoked military"
		government "Gegno Vi"
		personality heroic vindictive staying launching
		system "Vorsuke"
		ship "Schist" "Ess Utchec"
	npc
		to spawn
			has "provoked military"
		government "Gegno Vi"
		personality heroic vindictive staying entering
		system "Vorsuke"
		fleet
			names "gegno vi"
			variant
				"Gneiss"
				"Hornfel (Heavy Weapons)" 1
				"Diorite" 1
				"Eclogite" 3


mission "Foreign Spectator I"
	# invisible
	landing
	to offer
		random < 30
		has "First Contact: Gegno Scin: offered"
		not "Gegno Genocide Defense: offered"
	to complete
		never
	on enter "Eogho"
		fail

	npc
		on provoke
			set "interrupted arena"
		government "Gegno Vi"
		personality heroic vindictive ramming staying uninterested
		system "Eogho"
		ship "Eclogite" "Tschelgi Dueyu"
	npc
		on provoke
			set "interrupted arena"
		government "Gegno Scin"
		personality heroic vindictive staying uninterested
		system "Eogho"
		ship "Felsic" "Tschelgi Dueich"
	npc
		on provoke
			set "interrupted arena"
		government "Gegno Vi (Neutral)"
		personality heroic vindictive staying uninterested swarming
		system "Eogho"
		fleet
			names "gegno vi"
			variant
				"Hornfel" 2
				"Eclogite"
				"Slate"
	npc
		on provoke
			set "interrupted arena"
		government "Gegno Scin (Neutral)"
		personality heroic vindictive staying uninterested swarming
		system "Eogho"
		fleet
			names "gegno scin"
			variant
				"Coesite" 2
				"Tridymite"
				"Mica" 2


mission "Scin Suspicion"
	repeat
	# invisible
	landing
	deadline 11
	source
		near "Heutesl" 100
	to offer
		random < 70
		has "event: gegno suspicions"
		not "Scin Suspicion: offered"
		not "Gegno Genocide Defense: offered"
	to complete
		never
	npc save
		government "Gegno Scin"
		personality surveillance
		system
			government "Gegno Scin"
		fleet
			names "gegno scin"
			variant
				"Tridymite"


mission "Curious Civilians"
	# invisible
	landing
	to offer
		has "First Contact: Gegno Scin: offered"
		not "Gegno Genocide Defense: offered"
	to complete
		never
	on enter
		system
			government "Gegno"
		fail
		event "gegno suspicions"


mission "Esstch Visit Tracker"
	# invisible
	landing
	repeat 1
	source "Esstch"
	on offer
		fail


# mission "Transmission"
# A brief mission that pops up in Heutesl where a Gegno ship attempts to contact the player, or something.


mission "Brief Bystander"
	# invisible
	landing
	destination "Esstch"
	to offer
		has "Esstch Visit Tracker: offered" == 1
		has "First Contact: Gegno Scin: offered"
		not "Gegno Genocide Defense: offered"
	on complete
		conversation
			`As usual, the scattered recording instruments on the surface of this planet contradicts what little interest the Gegno appear to be giving it nowadays, despite its location within the Gegno's home system of Heutesl. Still, since this planet isn't strictly owned by the Gegno, it makes for a convenient place to stop, and they haven't seemed to either notice nor care when you have landed here before.`
			`	However, as you fly around this time, you notice a small Gegno shuttle parked on the ground. The tan coloration of its hull suggests that it's a civilian craft, but what it's doing here is unknown.`
			choice
				`	Investigate.`
					goto investigate
				`	Leave them be.`
					decline

			label investigate
			action
				set "gegno: approached bystander"
			`	You steer your ship towards the shuttle, and once you approach it, you are able to see a Gegno on the ground nearby fiddling with one of the nearby devices on the surface. Though, as you fly closer, they stop their work and return to their shuttle, taking off shortly after. It seems like they weren't interested in any potential interaction with you.`
			`	The satellite they were tinkering with doesn't strike you as anything special, being just another antique device amongst the others.`
				decline


mission "Gegno Intervention"
	# invisible
	landing
	source "Giaru Gegno"
	to offer
		has "event: gegno suspicions"
		has "Brief Bystander: done"
		has "Foreign Spectator I: failed"
		has "Passive-Aggressive Observations: done"
		not "Gegno Genocide Defense: offered"
	on offer
		conversation
			`After you go through your post-docking routine and enter the ringworld, you can't help but feel that something is a bit off. Normally the Quarg here would be swiftly walking about, focused on attending to their duties, but for some reason, there seems to be less of them around than usual. Moreover, those you do come across are occasionally having discussions with one another, sometimes looking in your direction even for the slightest second. What stands out the most is the lack of any Gegno in the area you're in at all.`
			`	A few minutes later, while you are making your way through the pristine interior of the ring, you hear a voice call to you from down one of the various branching corridors. Turning around, you recognize the unique attire of the Quarg that has helped you in the past, along with a few others.`
			`	"Circumstantial greetings once more, <first><last>. Might we have a significant moment of your attention?"`
			choice
				`	"Sure."`
					goto "follow"
				`	"How long will it take?"`
			`	"As long as is required, for this matter is of symbolic importance," it says, with a slightly elevated tone.`

			label follow
			`	You follow the group of Quarg to a smaller discussion room, similar to the one you've visited before. Or perhaps you've been visiting a different room each time, considering how unfathomably large a ringworld is. Once you sit down with the Quarg from before, it looks at you for a moment, looks down at the table, then back up to you.`
			
			branch "pacifist"
				has "gegno: left observations"
				has "gegno: left scin"
				not "gegno: approached bystander"
				not or
					"reputation: Gegno Vi" < 0
					"reputation: Gegno Scin" < 0

			`	"Formerly, I have offered suggestions of heedful interplay regarding the Gegno. However, we are increasingly aware of correlative happenings upon them involving yourself. It would seem consequential events have indeed occurred. Not often previously were we approached by Gegno, but a few notable occasions now have meaningful figures sought us out for inquiry as to your necessitations in meddling."`
			choice
				`	"I haven't done any harm to them."`
					to display
						not or
							"reputation: Gegno Vi" < 0
							"reputation: Gegno Scin" < 0
				`	"It was more coincidential than anything."`
					goto coincidence
				`	"Most of the time they were dismissive."`
					goto dismissive
				`	"They showed some interest in interaction."`
					goto interest

			`	"One does not need invoke violence to greatly harm another. However purest intentions may be, even the smallest unbeknownst action may rapidly tumble to one not forseenly desired." The Quarg then ponders for a moment.`
				goto cases

			label coincidence
			`	"Even a mere bland coincidence can cause the greatest of tragedies. An untroubled stone becomes a deadly meteor if it should fall many enough lengths." The Quarg then ponders for a moment.`
				goto cases

			label dismissive
			`	"It takes for an occurrence to exist in a first place to be dismissive of its happening. Despite this, the situation may not ultimately be happily welcomed beforehand." The Quarg then ponders for a moment.`
				goto cases

			label interest
			`	"Great curiosity does not equal great benefit. Even the most dangerous of creatures may glance but with interest at a moment's first." The Quarg then ponders for a moment.`
				goto cases

			label cases
			`	"Imagine, if you will, during the substantial conflicts the humans call the Turf Wars, a strange alien came to human space. We Quarg woefully witnessed that hazardous conflict - it was a time of great waste, unfortunate peril, and unsavory distrust among humanity. The Gegno are in a vulnerable state notably comparable to such a time. Reluctantly, the truth remains that we have been contacted by numerous members of high Gegno standing in respect to your continued interference. We wish for it to be matter only for further strict cautionaries, but regrettably, the Gegno believe it a matter beyond intricate attentiveness." The Quarg leaves its chair and motions you to do the same.`
			`	"Our best of recommendations to you is in departure from Gegno space as of this decisive moment. Meanwhile, we shall attempt a most careful negotiation with their hierarchy to come in terms of an acceptable toleration of storts. Should we find commonality, you will receive communication from one of the title 'Adrauni', as has been bestowed upon me."`
			`	The rest of the Quarg, who have been listening to the conversation attentively the whole time, begin to escort you out of the room. If the Gegno are willing to go as far as to contact the Quarg about your appearances, then this is truly an important matter to them. For the time being, it's probably best to listen to the Quarg's warnings this time around and leave Gegno space until some kind of resolution is found, if at all.`
				decline

			label pacifist
			`	"Formerly, I have offered suggestions of heedful interplay regarding the Gegno. We have been alerted of a few additional encounters you've experienced, although they seemed minimal in nature. In such cases, it has been generally described that you left in a timely manner, in which we are notably appreciative of."`
			`	"However," the Quarg continues, "despite your efforts in recommended cautions, there are some meaningful figures of Gegno standing that expressed frustration in your trivial appearances. They inquired us of the possibility of unnecessary reoccurences."`
			choice
				`	"Why does this frustrate them?"`
				`	"It was more coincidential than anything."`
					goto coincidental
				`	"I wish to learn more about them."`
					goto learn

			label coincidental
			`	"Even a mere brief coincidence may cause a result not desired, neither foreseen, by the instigator. All living things owe their existence to series of arbitrary coincidences." The Quarg then ponders for a moment.`
				goto imagine

			label learn
			`	"Not always does the desire to learn lead to pleasant opportunities. The most curious of creatures can easily be harmed when naive to the nature of their interests." The Quarg then ponders for a moment.`
				goto imagine
				
			label imagine
			`	"Imagine, if you will, during the substantial conflicts the humans call the Turf Wars, a strange alien came to human space. We Quarg woefully witnessed that hazardous conflict - it was a time of great waste, unfortunate peril, and unsavory distrust among humanity. The Gegno are in a vulnerable state notably comparable to such a time. The truth remains that we have been contacted by a few Gegno of importance in respect to your past presences, and there has been show of concern to your unstated intentions." After a brief pause, the Quarg looks to you in a strange manner, and you aren't sure what to make of it. "Though, unexpectedly, a select few times we have also been curiously asked of your origins, an experience we are not strongly familiar with involving the Gegno." The Quarg leaves its chair and motions you to do the same.`
			`	"Our best of recommendations to you is to avoid further contact in the coming future. Meanwhile, we shall attempt a most careful negotiation with their hierarchy to come to terms of a ground of acceptance for your presence. Should we find commonality, you will receive communication from one of the title 'Adrauni', as has been bestowed upon me."`
			`	The rest of the Quarg, who have been listening to the conversation attentively the whole time, begin to escort you out of the room. If the Gegno are willing to go as far as to contact the Quarg about your appearances, then this is truly an important matter to them. For the time being, it's probably best to allow the Quarg to find some kind of resolution with the Gegno while you keep your distance.`
				decline


mission "Under the Nose"
	# invisible
	landing
	source "Giaru Gegno"
	to offer
		has "event: recurring rumors"
		not "Gegno Genocide Defense: offered"
	to complete
		never
	on enter "Aleit"
		fail

	npc
		on kill
			set "yvx killed"
		government "Gegno Vi"
		personality heroic vindictive ramming daring entering fleeing uninterested
		system "Aleit"
		ship "Rhyolite" "Imtydei"


mission "Veering Vi A"
	repeat
	# invisible
	landing
	deadline 7
	to offer
		random < 30
		has "Gegno Intervention: declined"
		not "Vi Backlash A: active"
		not "Gegno Genocide Defense: offered"

	npc
		on kill
			"vi backlash" ++
		system "Ookmya"
		government "Gegno Vi (Combative)"
		personality heroic staying
		fleet
			names "gegno vi"
			variant 5
				"Dunite"
			variant
				"Dunite" 2


mission "Veering Vi B"
	repeat
	# invisible
	landing
	deadline 7
	to offer
		random < 30
		has "Gegno Intervention: declined"
		not "Vi Backlash B: active"
		not "Gegno Genocide Defense: offered"

	npc
		on kill
			"vi backlash" ++
		system
			government "Gegno Vi"
		government "Gegno Vi (Combative)"
		personality heroic staying
		fleet
			names "gegno vi"
			variant
				"Eclogite"


mission "Vi Backlash"
	# invisible
	landing
	to offer
		"vi backlash" >= 5
		"reputation: Gegno Vi" <= 0
	on offer
		fail
		"reputation: Gegno Vi" = -1


mission "Scin Presence on Cyife"
	# invisible
	landing
	source "Cyife"
	to offer
		random < 30
		has "Gegno Intervention: declined"
		not "Gegno Genocide Defense: offered"
	on offer
		set "visited cyife"
		conversation
			`Nothing is much of interest on a cold, unwelcoming moon in the middle of nowhere. However, there's something about the surface of Cyife that is a bit peculiar. Some of the light refracted through the surface seeminly dissipates, or reflects back in strange patterns. Although appearing like ice, more detailed inspection reveals that small patches of the terrain seem to be made of some other type of crystalline material. In the distance is something that truly stands out on this world - a large egg-shaped structure with a green hue to it.`

			branch "saw epidote"
				has "scin: approached epidote"

			branch "boarded epidote"
				has "scin: entered epidote"

			`	Once you get close enough, the oblong object reveals itself to be some sort of large Gegno ship, and judging by the coloring, belongs to the Scin faction. What it's doing this far away from their home space is a mystery, much like the moon it's stationed on. Or, at least, was stationed on, as after a few seconds, it launches into the atmosphere and leaves the moon. There doesn't seem to be anything left at the place it was parked at, so it's hard to know the Scin were doing here to begin with.`
				decline

			label "saw epidote"
			`	Once you get close enough, the oblong object reveals itself to be a large Gegno Scin ship, similar to the one you encountered during an interaction with the Scin a while ago. What it's doing this far away from their home space is a mystery, much like the moon it's stationed on. Or, at least, was stationed on, as after a few seconds, it launches into the atmosphere and leaves the moon. Perhaps it was some sort of warship spying on the nearby Gegno Vi systems.`
				decline

			label "boarded epidote"
			`	Once you get close enough, the oblong object reveals itself to be one of the Gegno Scin's large research ships, the same kind that you've been inside of during an interaction with the Scin a while ago. It's possible the Scin found the mysteriousness of Cyife worth traveling so far from their home space to investigate, but you'll never know, as after a few seconds, the ship launches into the atmosphere and leaves the moon. They also didn't seem to leave anything behind, though the site the ship was parked at does appear to be one of the many strange regions of the moon.`
				decline


# Need the ability to define where an NPC fleet goes separate from the player.
mission "Battle over Zydee"
#	invisible
	landing
	to offer
#		random < 30
		has "Gegno Intervention: declined"
		not "Gegno Genocide Defense: offered"
	source "Zydee"
#	to complete
#		never
	on offer
		set "zydee appearance"
#		conversation
			`Background simulator - Gegno Vi attack on the Scin world of Zydee.`
	on enter "Kneirc"
		fail

	npc
		on provoke
			set "zydee interference"
		government "Gegno Vi"
		personality heroic staying
		system "Kneirc"
		fleet
			variant
				"Diorite"
				"Eclogite"
	npc
		on provoke
			set "zydee interference"
		government "Gegno Scin"
		personality heroic staying
		system "Kneirc"
		fleet
			variant
				"Epidote"
				"Coesite" 2
				"Halite"
	npc evade
		on provoke
			set "zydee interference"
		government "Gegno Vi"
		personality heroic
		system "Eogho"
		fleet
			variant
				"Gneiss"
				"Hornfel" 3
				"Diorite"
				"Schist" 2
				"Eclogite" 4
	npc evade
		on provoke
			set "zydee interference"
		government "Gegno Scin"
		personality heroic
		system "Erba Yle"
		fleet
			variant
				"Felsic" 2
				"Coesite" 3
	npc evade
		on provoke
			set "zydee interference"
		government "Gegno Scin"
		personality heroic
		system "Auhru"
		fleet
			variant
				"Feldspar"
				"Felsic"
				"Coesite" 2
				"Halite" 6
	npc evade
		on provoke
			set "zydee interference"
		government "Gegno Scin"
		personality heroic
		system "Zeinar"
		fleet
			variant
				"Coesite" 2


# mission "Quarg Reach Understanding" (Quarg follow player to Dueyu Eitch and find grounds with the Gegno"


# Need the ability to relocate the player.
# mission "Too far" (The player continues to be nosy with the Gegno and conseqences occur"


# mission "Acquiescence"


# jobs (mining)


# mission "Heart of the Mighty"


# mission "Heart of the Clever"


# jobs (cargo)


# mission "Derelict Desponders A"


# mission "Derelict Desponders B"


# Don't forget edits based on rep:
# 	Vi more angry at you if hostile to them during Passive-Aggressive
#	Interruption Consequence for Eogho Duel (set a condition)
#	If Quarg are hostile to begin with
#	Fleet size difference for level of hostility for either faction in Aquiescence
#	Cap of hostility with either/both war factions prevents further story content
# 	Etc..
